<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CSS product code: weilei_lib/dist.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="weilei-logo-small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CSS product code
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">C++ library to estimate distance of CSS codes. Some particular construction of CSS codes are implemented.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('dist_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">dist.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="dist_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//Weilei Zeng, April 28</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//return min weight of rows in C, which is the distance of the code</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//random window method is applied with default number of permutation 10.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160; </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//#include &quot;weilei_lib/my_lib.h&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="dist_8h.html">dist.h</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="lib_8h.html">lib.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mm__read_8h.html">mm_read.h</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mm__write_8h.html">mm_write.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160; </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno"><a class="line" href="namespacecommon.html#a465d743c58916cfea99a1e51a5f01c59">   12</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacecommon.html#a465d743c58916cfea99a1e51a5f01c59">common::min_wt_decoding</a>(itpp::GF2mat C){</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <span class="comment">//  std::cout&lt;&lt;C&lt;&lt;endl;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <span class="comment">//when C is not so large, we can apply the true min weight decoding</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="comment">//  int rowC=C.rows();</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="comment">//  std::cout&lt;&lt;&quot;rowC = &quot;&lt;&lt;rowC&lt;&lt;endl;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  itpp::bvec alpha(C.rows());<span class="comment">//a binary vector for linear combination of codeword</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  itpp::GF2mat alphaM(1,C.rows());</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <span class="keywordtype">int</span> max = pow(2,C.rows());</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;  itpp::bvec codeword(C.cols());</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="keywordtype">int</span> wt, min_wt=C.cols();</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  itpp::bvec zero = itpp::zeros_b(C.cols());</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="comment">//  std::cout&lt;&lt;&quot;min_wt_decodnig&quot;&lt;&lt;endl;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="comment">//  std::cout&lt;&lt;&quot;max = &quot;&lt;&lt;max&lt;&lt;endl&lt;&lt;C.rows()&lt;&lt;endl;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="comment">//  itpp::bvec min_codeword=zero;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i =1;i&lt;max;i++){</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="comment">//    itpp::dec2bin(i,alpha);</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    alpha = itpp::dec2bin(C.rows(),i);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    alphaM.set_row(0,alpha);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">//std::cout&lt;&lt;i&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">//    std::cout&lt;&lt;&quot;alpha = &quot;&lt;&lt;alpha&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    codeword=(alphaM*C).get_row(0);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    wt = itpp::BERC::count_errors(zero,codeword);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">//    if ( wt &lt; min_wt ) min_codeword=codeword;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    min_wt = (wt&lt;min_wt)? wt : min_wt;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span> ( min_wt == 1) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">//  std::cout&lt;&lt;&quot;min wt codeword: &quot;&lt;&lt;min_codeword&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">return</span> min_wt;    </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//G for gauge operators, and C for bare logical operators</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//code word c = alpha_C*C+alpha_G*G, where alpha_C \neq 0</span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="namespacecommon.html#a5375973150a549fec46ac672d95efed6">   44</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacecommon.html#a465d743c58916cfea99a1e51a5f01c59">common::min_wt_decoding</a>(itpp::GF2mat C,itpp::GF2mat G){</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="comment">//  std::cout&lt;&lt;&quot;call min_wt_decoding&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">// make sure G and C are full rank before calling this function. Otherwise it is a waste of computing power.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">int</span> C_rows=C.rows(), G_rows=G.rows();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">int</span> dec_C=(int) pow(2, C_rows);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">int</span> dec_G=(int) pow(2, G_rows);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordtype">int</span> N=C.cols();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  itpp::bvec bvec_C;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  itpp::bvec bvec_zero=itpp::zeros_b(N);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  itpp::GF2mat alpha_C(1,C_rows), alpha_G(1,G_rows);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span> wt=N, min_wt=N;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">//I should save a static copy of this alpha matrix, instead of generate it in two for loops every time.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 1; i &lt; dec_C ; i++){</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    alpha_C.set_row(0,itpp::dec2bin(C_rows,i));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j = 0; j &lt; dec_G; j++){</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      alpha_G.set_row(0,itpp::dec2bin(G_rows,j));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      bvec_C = (alpha_C * C + alpha_G * G).get_row(0);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="comment">//    std::cout&lt;&lt;bvec_C&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      wt = itpp::BERC::count_errors(bvec_zero,bvec_C);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="comment">//      if ( wt &lt; min_wt ) min_codeword=codeword;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      min_wt = (wt&lt;min_wt)? wt : min_wt;      </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span> ( min_wt == 1 ) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">//  std::cout&lt;&lt;&quot;                          finish min_wt_decoding&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">return</span> min_wt;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="namespacecommon.html#ae8dffa9806ddd0d220fb09db4ccf557c">   73</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacecommon.html#ae8dffa9806ddd0d220fb09db4ccf557c">common::save_dist</a>(<span class="keywordtype">int</span> d,<span class="keywordtype">char</span> * filename){</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  itpp::mat mat_d(1,1);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  mat_d.set(0,0,d);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="mm__write_8cpp.html#a43fa4cd6780c2cae3ae6a9a70004cb45">mat_to_MM</a>(mat_d,filename);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="namespacecommon.html#ae0e9f18c9c64fdb743ffaf3e7746bfc9">   82</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacecommon.html#ae0e9f18c9c64fdb743ffaf3e7746bfc9">common::rand_dist</a>(itpp::GF2mat C, <span class="keywordtype">int</span> perm_try){<span class="comment">//default perm_try=10</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">//  return min wt of rows in C</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">if</span> (C.rows()&lt;7){ <span class="comment">//for small codes, use true min wt decoding</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="css_8h.html#a27ae1dd5b3bc312c4c9942074b80b3fe">min_wt_decoding</a>(C);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">//use random window decoder to find min wt of C</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">//  RNG_randomize(); do not use it here. run it in the main program</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  itpp::bvec row_vec,zero=itpp::zeros_b(C.cols());</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordtype">int</span> wt,min_wt=C.cols();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  itpp::ivec perm;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  itpp::GF2mat T,U;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  itpp::ivec P;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;perm_try;j++){</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    perm = sort_index( itpp::randu(C.cols()) );</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    C.permute_cols(perm,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">//no need to permute back; can also permute the rows</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">//permute rows also</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    perm = sort_index( itpp::randu(C.rows()) );</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    C.permute_rows(perm,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    C.T_fact(T,U,P);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0;i&lt;C.rows();i++){</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      row_vec = C.get_row(i);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      wt = itpp::BERC::count_errors(zero,row_vec);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">if</span> (wt &lt; min_wt){</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    min_wt = wt;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">//  std::cout&lt;&lt;row_vec&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">return</span> min_wt;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="namespacecommon.html#a4e11db412889fa91c60dd3d6463ac1c3">  114</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacecommon.html#a4e11db412889fa91c60dd3d6463ac1c3">common::classical_dist</a>(itpp::GF2mat G){</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">//return distance of a classical code GH^t=0</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="comment">//G is parity check matrix</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  itpp::GF2mat T,U;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  itpp::ivec P;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordtype">int</span> rank_of_G = G.transpose().T_fact(T,U,P);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">if</span> ( rank_of_G == G.cols()  ){</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="css_8h.html#a14c9dbab105f1b8b8182a022d73e610c">INF</a>;<span class="comment">//999;//999 for infinity</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  itpp::GF2mat H = T.get_submatrix(rank_of_G,0,G.cols()-1,G.cols()-1);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span> (H.rows()&lt;7){<span class="comment">//use true min wt decoding for small codes.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="css_8h.html#a27ae1dd5b3bc312c4c9942074b80b3fe">min_wt_decoding</a>(H);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">int</span> min_wt = <a class="code" href="css_8h.html#a35934c85caabcc67d8f42d2d9aceec5d">rand_dist</a>(H);<span class="comment">//default permutation = 10</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordflow">return</span> min_wt;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">//return H such that GH^T = 0, and rank G + rank H = n = full rank</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="namespacecommon.html#aefd63d8b6f5191f95cd661ea837f7418">  133</a></span>&#160;itpp::GF2mat <a class="code" href="namespacecommon.html#aefd63d8b6f5191f95cd661ea837f7418">common::nullSpace</a>(itpp::GF2mat G){</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  itpp::GF2mat T,U; itpp::ivec P;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordtype">int</span> n=G.cols();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordtype">int</span> rank_of_G = G.transpose().T_fact(T,U,P);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">//  itpp::GF2matPrint(T,&quot;T&quot;);</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  itpp::GF2mat Q=T.get_submatrix(rank_of_G,0,n-1,n-1);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="keywordflow">return</span> Q;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="namespacecommon.html#ab4dbe7a319fbe38de1b2580a23c91d0a">  143</a></span>&#160;itpp::GF2mat <a class="code" href="namespacecommon.html#ab4dbe7a319fbe38de1b2580a23c91d0a">common::getC</a>(itpp::GF2mat <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>,itpp::GF2mat <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>,<span class="keywordtype">int</span> flip){</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">//return C_x</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">//flip=1 to get C_z</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keywordflow">if</span> (flip==1){</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    itpp::GF2mat temp=<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>=<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>=temp;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  itpp::GF2mat T,U;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  itpp::ivec P;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">int</span> rank_of_G_z =   <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.transpose().T_fact(T,U,P);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  itpp::GF2mat Q=T.get_submatrix(rank_of_G_z,0,<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.cols()-1,<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.cols()-1);<span class="comment">//Q include G_x and C_x/L_x</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  itpp::GF2mat GQ=<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.concatenate_vertical(Q);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  GQ.T_fact(T,U,P);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">int</span> rank_of_G_x = <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.row_rank();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="keywordtype">int</span> rank_of_Q = Q.rows();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">if</span> (rank_of_G_x == rank_of_Q){</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    std::cout&lt;&lt;<span class="stringliteral">&quot;getC(): It is not a quantum code:zero rank for codeword space&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">//    return;</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">if</span> ( <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.cols()-rank_of_G_z-rank_of_G_x &lt; 1){</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    std::cout&lt;&lt;<span class="stringliteral">&quot;empty code space&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">throw</span> <span class="stringliteral">&quot;empty code space&quot;</span>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">//  itpp::GF2matPrint(G_x,&quot;G_x&quot;);</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">//  itpp::GF2matPrint(U,&quot;U&quot;);</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  itpp::GF2mat C = U.get_submatrix(rank_of_G_x,0,rank_of_Q-1,<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.cols()-1 );</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  C.permute_cols(P,<span class="keyword">true</span>);<span class="comment">//codewords/logical group </span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">//check  if ((G_z*C.transpose()).is_zero() ){    std::cout&lt;&lt;&quot;GOOD C&quot;&lt;&lt;std::endl;  }</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">//  std::cout&lt;&lt;&quot;get C&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">return</span> C;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="namespacecommon.html#ae2ba17139296db4319223227af72e99d">  179</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacecommon.html#ae2ba17139296db4319223227af72e99d">common::quantum_dist_v2</a>(itpp::GF2mat <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>, itpp::GF2mat <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>, <span class="keywordtype">int</span> flip){<span class="comment">//without expected value</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">//right or x  distance of (G_x,G_z)</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">//flip left and right if flip = 1;</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordtype">int</span> trialQ=500;<span class="comment">//100 is good for not so big codes;permute GQ this max amount of time</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">//  int trialQflag=1;//a falg to control the max amout of permutation</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">if</span> (flip==1){<span class="comment">//flip G_x and G_z</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    itpp::GF2mat temp=<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>;    <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>=<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>;    <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>=temp;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  itpp::GF2mat T,U;  itpp::ivec P;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordtype">int</span> rank_of_G_z =   <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.transpose().T_fact(T,U,P);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// for small code, use min_wt_decoding to return X distance</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.cols() - rank_of_G_z &lt; 11){</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="css_8h.html#a27ae1dd5b3bc312c4c9942074b80b3fe">min_wt_decoding</a>(<a class="code" href="css_8h.html#a92e1a1f0761f740c218c54bd7a694e9f">getC</a>(<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>, <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>), <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  } </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  itpp::GF2mat Q=T.get_submatrix(rank_of_G_z,0,<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.cols()-1,<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.cols()-1);<span class="comment">//Q include G_x and C_x/L_x</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  itpp::GF2mat GQ=<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.concatenate_vertical(Q);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordtype">int</span> min_wt=GQ.cols(),wt;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> iq=0;iq&lt;trialQ;iq++){</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    itpp::ivec perm = sort_index(  itpp::randu( GQ.cols()  ));<span class="comment">//random permutation</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    GQ.permute_cols(perm,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    GQ.T_fact(T,U,P);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">int</span> rank_of_G_x = <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.row_rank();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">int</span> rank_of_Q = Q.rows();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (rank_of_G_x == rank_of_Q){</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="css_8h.html#a14c9dbab105f1b8b8182a022d73e610c">INF</a>;<span class="comment">//999 for infinity</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    itpp::GF2mat C = U.get_submatrix(rank_of_G_x,0,rank_of_Q-1,<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.cols()-1 );</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    C.permute_cols(P,<span class="keyword">true</span>);<span class="comment">//codewords/logical group //not necessary to permute it back here</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    wt = <a class="code" href="css_8h.html#a35934c85caabcc67d8f42d2d9aceec5d">rand_dist</a>(C);<span class="comment">//defauylt permutation = 10</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    trialQ=(wt&lt;min_wt)? ( (10*iq &gt; trialQ)? 10*iq : trialQ ):trialQ;<span class="comment">//make sure this is the true min weight</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    min_wt=(wt&lt;min_wt)? wt:min_wt;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">if</span> (min_wt ==1) <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">//    std::cout&lt;&lt;&quot;iq = &quot;&lt;&lt;iq&lt;&lt;&quot;, [wt=&quot;&lt;&lt;wt&lt;&lt;&quot;] &quot;&lt;&lt;std::endl;;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">//  std::cout&lt;&lt;&quot;got min wt of logical operator C  = &quot;&lt;&lt;min_wt&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">//save_dist(min_wt,filename_dist);</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">return</span> min_wt;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="namespacecommon.html#a71dea63a10493ab59f4545a2e1e8f94a">  228</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacecommon.html#a71dea63a10493ab59f4545a2e1e8f94a">common::quantum_dist</a>(itpp::GF2mat <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>, itpp::GF2mat <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>, <span class="keywordtype">int</span> dist_expected, <span class="keywordtype">int</span> debug, <span class="keywordtype">int</span> flip){</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="comment">//right or x  distance of (G_x,G_z)</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="comment">//flip left and right if flip = 1;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">int</span> trialQ=50000;<span class="comment">//1000;permute GQ this max amount of time</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">if</span> ( dist_expected &gt; 10 ) trialQ = trialQ*2;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordtype">int</span> trialQflag=1;<span class="comment">//a flag to adjust the max amount of permutation</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">if</span> (flip==1){<span class="comment">//flip G_x and G_z</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    itpp::GF2mat temp=<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>;    <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>=<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>;    <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>=temp;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  itpp::GF2mat T,U;  itpp::ivec P;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordtype">int</span> rank_of_G_z =   <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.transpose().T_fact(T,U,P);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  itpp::GF2mat Q=T.get_submatrix(rank_of_G_z,0,<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.cols()-1,<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.cols()-1);<span class="comment">//Q include G_x and C_x/L_x</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">//  std::cout&lt;&lt;Q.row_rank()&lt;&lt;&quot;,&quot;&lt;&lt;G_z.row_rank()&lt;&lt;&quot;,&quot;&lt;&lt;G_z.cols()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  itpp::GF2mat GQ=<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.concatenate_vertical(Q);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordtype">int</span> min_wt=GQ.cols(),wt;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> iq=0;iq&lt;trialQ;iq++){</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    itpp::ivec perm = sort_index(  itpp::randu( GQ.cols()  ));<span class="comment">//random permutation</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    GQ.permute_cols(perm,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    GQ.T_fact(T,U,P);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="keywordtype">int</span> rank_of_G_x = <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.row_rank();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">int</span> rank_of_Q = Q.rows();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> (rank_of_G_x == rank_of_Q){</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="css_8h.html#a14c9dbab105f1b8b8182a022d73e610c">INF</a>;<span class="comment">//999 for infinity</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    itpp::GF2mat C = U.get_submatrix(rank_of_G_x,0,rank_of_Q-1,<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.cols()-1 );</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    C.permute_cols(P,<span class="keyword">true</span>);<span class="comment">//codewords/logical group //not necessary to permute it back here</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">//Question 1: does the row in C include some stabilizer generators which may increase its weight?</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    wt = <a class="code" href="css_8h.html#a35934c85caabcc67d8f42d2d9aceec5d">rand_dist</a>(C);<span class="comment">//defauylt permutation = 10</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    min_wt=(wt&lt;min_wt)? wt:min_wt;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">//std::cout&lt;&lt;&quot;iq = &quot;&lt;&lt;iq&lt;&lt;&quot;, [wt=&quot;&lt;&lt;wt&lt;&lt;&quot;] &quot;&lt;&lt;std::endl;;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">//  std::cout&lt;&lt;&quot;got min wt of logical operator C  = &quot;&lt;&lt;min_wt&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">//save_dist(min_wt,filename_dist);</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">int</span> max_trial = 0;<span class="comment">//no need to run C again, always get the same result</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0;i&lt;max_trial;i++){</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      wt=<a class="code" href="css_8h.html#a35934c85caabcc67d8f42d2d9aceec5d">rand_dist</a>(C);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      min_wt=(wt&lt;min_wt)? wt:min_wt;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span> (trialQflag) {<span class="comment">//adjust the max number of permutation, only do this once</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> (min_wt &lt;= dist_expected){</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      trialQflag=0;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      trialQ = 10*iq;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="comment">// continue to run to see if smaller distance can be achieved.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      trialQ=(trialQ&lt;1000)? 1000:trialQ;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">if</span> (debug) std::cout&lt;&lt;<span class="stringliteral">&quot;quantum_dist: reach min distance when iq = &quot;</span>&lt;&lt;iq&lt;&lt;<span class="stringliteral">&quot;, continue to run with trialQ = &quot;</span>&lt;&lt;trialQ&lt;&lt;std::endl;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">return</span> min_wt;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="namespacecommon.html#aa6ee21f31592282a5308891946fa742a">  292</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacecommon.html#aa6ee21f31592282a5308891946fa742a">common::hypergraph_dist</a>(itpp::GF2mat Aj, itpp::GF2mat Ajplus,<span class="keywordtype">int</span> dist_expected,<span class="keywordtype">int</span> flip){</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  itpp::GF2mat <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a> = Aj;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  itpp::GF2mat <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a> = Ajplus.transpose();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="comment">//check commutation</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">/*  if ( (Aj*Ajplus).is_zero()){</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">    //pass</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">  }else{</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">    std::cout&lt;&lt;&quot;It is not a CSS code!&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">    }*/</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">if</span> (flip==1){</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    itpp::GF2mat temp=<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>=<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>=temp;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">/* char * filename_G_x = argv[1];</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">  char * filename_G_z = argv[2];</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">  char * filename_C_x = argv[3];</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">  char * filename_dist = argv[4];</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">//  itpp::GF2mat G_z = MM_to_GF2mat(filename_G_z);</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  itpp::GF2mat T,U;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  itpp::ivec P;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">int</span> rank_of_G_z =   <a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.transpose().T_fact(T,U,P);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  itpp::GF2mat Q=T.get_submatrix(rank_of_G_z,0,<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.cols()-1,<a class="code" href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a>.cols()-1);<span class="comment">//Q include G_x and C_x/L_x</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">//  itpp::GF2mat G_x=MM_to_GF2mat(filename_G_x);</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  itpp::GF2mat GQ=<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.concatenate_vertical(Q);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordtype">int</span> min_wt=GQ.cols(),wt;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordtype">int</span> trialQ=1000;<span class="comment">//1000;</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> iq=0;iq&lt;trialQ;iq++){</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    itpp::ivec perm = sort_index(  itpp::randu( GQ.cols()  ));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    GQ.permute_cols(perm,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    GQ.T_fact(T,U,P);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">int</span> rank_of_G_x = <a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.row_rank();</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">int</span> rank_of_Q = Q.rows();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (rank_of_G_x == rank_of_Q){</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="comment">//      std::cout&lt;&lt;&quot;It is not a quantum code!&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">if</span> (dist_expected != 999){</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    std::cout&lt;&lt;std::endl&lt;&lt;<span class="stringliteral">&quot;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!NOTICE!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!NOTICE!!!!!!!!!!!!!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    std::cout&lt;&lt;<span class="stringliteral">&quot;(&quot;</span>&lt;&lt;dist_expected&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="keywordflow">return</span> 999;<span class="comment">//999 for infinity</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    itpp::GF2mat C = U.get_submatrix(rank_of_G_x,0,rank_of_Q-1,<a class="code" href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a>.cols()-1 );</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    C.permute_cols(P,<span class="keyword">true</span>);<span class="comment">//codewords/logical group //not necessary to permute it back here</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">//Question 1: does the row in C include some stabilizer generators which may increase its weight?</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">//itpp::GF2mat_to_MM(C,filename_C_x);</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    wt = <a class="code" href="css_8h.html#a35934c85caabcc67d8f42d2d9aceec5d">rand_dist</a>(C);<span class="comment">//defauylt permutation = 10</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    min_wt=(wt&lt;min_wt)? wt:min_wt;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">//  std::cout&lt;&lt;&quot;got min wt of logical operator C  = &quot;&lt;&lt;min_wt&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">//save_dist(min_wt,filename_dist);</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">//    std::cout&lt;&lt;&quot;&lt;&quot;&lt;&lt;wt&lt;&lt;&quot;&gt;&quot;;      </span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordtype">int</span> max_trial = 0;<span class="comment">//no need to run C again, always get the same result</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0;i&lt;max_trial;i++){</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">if</span> (min_wt == dist_expected){</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">//great job! return the result</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (min_wt &lt; dist_expected){</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="comment">//      std::cout&lt;&lt;&quot;Damn! how could this happen!&quot;&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">//    std::cout&lt;&lt;&quot;(&quot;&lt;&lt;dist_expected&lt;&lt;&quot;)&quot;;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="comment">//continue another run</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="comment">//      std::cout&lt;&lt;&quot;#RUN AGAIN#&quot;&lt;&lt;min_wt;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      wt=<a class="code" href="css_8h.html#a35934c85caabcc67d8f42d2d9aceec5d">rand_dist</a>(C);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      min_wt=(wt&lt;min_wt)? wt:min_wt;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="comment">//      std::cout&lt;&lt;&quot;&lt;&quot;&lt;&lt;wt&lt;&lt;&quot;&gt;&quot;;</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">if</span> (min_wt == dist_expected){</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">//final check</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">if</span> (min_wt != dist_expected){</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    std::cout&lt;&lt;std::endl&lt;&lt;<span class="stringliteral">&quot;!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!NOTICE!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!NOTICE!!!!!!!!!!!!!&quot;</span>&lt;&lt;std::endl;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    std::cout&lt;&lt;<span class="stringliteral">&quot;(&quot;</span>&lt;&lt;dist_expected&lt;&lt;<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keywordflow">return</span> min_wt;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="namespacecommon.html#a14101bccfd5653a95f9f6c552595c062">  389</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacecommon.html#a14101bccfd5653a95f9f6c552595c062">common::draw_toric_x_error</a>(itpp::bvec error_bits){</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="comment">//  std::cout&lt;&lt;&quot;draw with weight = &quot;&lt;&lt;weight(error_bits)&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="comment">//  if (true) return 0 ;</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="comment">//draw ( but not print) error for the toric code</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="comment">//in stabilizer generating matrix, we have vertex for X and plaquette for Z</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="comment">//use plaquette to check X error and vertex to check Z errors</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">//for indexing, start from the plaqutte in the top left. Its top bond has index one, and then move to the right and then move down. After finishing all horizontal bonds in the lattice, Start from its left bond with index n*n, the move right and move down.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordtype">int</span> N=error_bits.length(); <span class="comment">//size of the code N=2*n*n</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordtype">int</span> n=(int) sqrt(N/2); <span class="comment">//size of the lattice</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">//first row of horizontal bonds</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  std::cout&lt;&lt;<span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j=0; j&lt;n; j++){</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">if</span> (error_bits.get(n*0+j)){</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      std::cout&lt;&lt;<a class="code" href="namespacecommon.html#a71f7ab65b8afbe48b20c3f0bf1718920">color_text</a>(<span class="stringliteral">&quot;_ &quot;</span>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      std::cout&lt;&lt;<span class="stringliteral">&quot;_ &quot;</span>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=1;i&lt;n;i++){</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j=0; j&lt;n; j++){</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">if</span> (error_bits.get(n*(i-1)+n*n+j)){</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    std::cout&lt;&lt;<a class="code" href="namespacecommon.html#a71f7ab65b8afbe48b20c3f0bf1718920">color_text</a>(<span class="stringliteral">&quot;|&quot;</span>);<span class="comment">//&quot;1&quot;;//for error bits</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    std::cout&lt;&lt;<span class="stringliteral">&quot;|&quot;</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordflow">if</span> (error_bits.get(n*i+j)){</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    std::cout&lt;&lt;<a class="code" href="namespacecommon.html#a71f7ab65b8afbe48b20c3f0bf1718920">color_text</a>(<span class="stringliteral">&quot;_&quot;</span>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">//for error bits</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    std::cout&lt;&lt;<span class="stringliteral">&quot;_&quot;</span>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="comment">//the last row of vertical bonds</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> j=0; j&lt;n; j++){</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (error_bits.get(n*(n-1)+n*n+j)){</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="comment">//      std::std::cout&lt;&lt;&quot;\033[0;32m 1 \033[0m&quot;;</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      std::cout&lt;&lt;<a class="code" href="namespacecommon.html#a71f7ab65b8afbe48b20c3f0bf1718920">color_text</a>(<span class="stringliteral">&quot;| &quot;</span>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      std::cout&lt;&lt;<span class="stringliteral">&quot;| &quot;</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  std::cout&lt;&lt;std::endl;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="namespacecommon.html#addda95e787e17fd0085edd67ef472bb8">  439</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespacecommon.html#a14101bccfd5653a95f9f6c552595c062">common::draw_toric_x_error</a>(itpp::bvec error_bits, std::string header){</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  std::cout&lt;&lt;header.c_str()&lt;&lt;std::endl;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <a class="code" href="css_8h.html#ad621ceea86c12918ae754e4c2de2e7dc">draw_toric_x_error</a>(error_bits);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;}</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="namespacecommon.html#a5a49dcd20316566f32d75e6325e74307">  446</a></span>&#160;itpp::bvec <a class="code" href="namespacecommon.html#a5a49dcd20316566f32d75e6325e74307">common::find_error</a>(itpp::bvec e_in, itpp::GF2mat H){</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="comment">//input: original error and parity check matrix</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">//output: an error with same syndrome</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="comment">//for principle, see random window decoder</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">//  std::cout&lt;&lt;H.rows()&lt;&lt;&quot;  row rank &quot;&lt;&lt; H.row_rank()&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  H = <a class="code" href="namespacecommon.html#a1b9cada7d2095a6979d19ac55144fb0a">make_it_full_rank</a>(H);  <span class="comment">//H may not have full rank</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  itpp::GF2mat H0=H;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  itpp::bvec e_t = e_in;<span class="comment">//change name</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  itpp::bvec s=H*e_t;<span class="comment">//syndrome</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  H.set_size(H.rows(),H.cols()+1,<span class="keyword">true</span>);<span class="comment">//H=(H_x,s)</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  H.set_col(H.cols()-1,s);<span class="comment">//add syndrome</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  itpp::GF2mat T,U;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  itpp::ivec P;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  H.transpose().T_fact(T,U,P);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  itpp::GF2mat Q=T.get_submatrix(H.rows(),0,H.cols()-1,H.cols()-1);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  itpp::bvec X_t=Q.get_row(Q.rows()-1);<span class="comment">//the error detected, X_t=(X_z,X_x,1)</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  X_t.set_size(X_t.size()-1,<span class="keyword">true</span>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">return</span> X_t;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="namespacecommon.html#a2870fe9e08d03362c8fb728d874d88f4">  471</a></span>&#160;itpp::GF2mat <a class="code" href="namespacecommon.html#a2870fe9e08d03362c8fb728d874d88f4">common::get_check_code734</a>(<span class="keywordtype">int</span> L){<span class="comment">//L=7n</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">//return check matrix code code [7,3,4], find definition in research note.pdf</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  itpp::GF2mat G(L,L);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0;i&lt;L;i++){</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    G.set(i,i,1);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (i+2&gt;L-1) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      G.set(i,i+2-L,1);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      G.set(i,i+2,1);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">if</span> (i+3&gt;L-1) {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      G.set(i,i+3-L,1);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      G.set(i,i+3,1);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">return</span> G;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;}</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno"><a class="line" href="namespacecommon.html#ab7d9f3797598153b6972dd52466e47b3">  490</a></span>&#160;itpp::GF2mat <a class="code" href="namespacecommon.html#ab7d9f3797598153b6972dd52466e47b3">common::get_check_code743</a>(<span class="keywordtype">int</span> L){<span class="comment">//L=7n</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">//return check matrix code code [7,4,3], find definition in research note.pdf</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  itpp::GF2mat G(L,L);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i=0;i&lt;L;i++){</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    G.set(i,i,1);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">if</span> (i+2&gt;L-1) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      G.set(i,i+2-L,1);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      G.set(i,i+2,1);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">if</span> (i+3&gt;L-1) {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      G.set(i,i+3-L,1);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      G.set(i,i+3,1);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    }</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">if</span> (i+4&gt;L-1) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      G.set(i,i+4-L,1);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    }<span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      G.set(i,i+4,1);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="keywordflow">return</span> G;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="namespacecommon.html#a6226b1e6cf8154a83d19b11a12c659ef">  513</a></span>&#160;itpp::GF2mat <a class="code" href="namespacecommon.html#a6226b1e6cf8154a83d19b11a12c659ef">common::get_check_rept</a>(<span class="keywordtype">int</span> L){<span class="comment">//return circulant check matrix for repetition code of length L</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  itpp::GF2mat a(L,L);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;L-1;i++){<span class="comment">//construct a : circulant check matrix for repetition code</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    a.set(i,i,1);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    a.set(i,i+1,1);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  a.set(L-1,L-1,1);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  a.set(L-1,0,1);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">//std::cout&lt;&lt;&quot;circulant check matrix for repetition code : a = &quot;&lt;&lt;a&lt;&lt;std::endl;</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">return</span> a;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;}</div>
<div class="line"><a name="l00524"></a><span class="lineno"><a class="line" href="namespacecommon.html#a5d93210c56c7f5315b9341a66a87828f">  524</a></span>&#160;itpp::GF2mat <a class="code" href="namespacecommon.html#a5d93210c56c7f5315b9341a66a87828f">common::get_check</a>(<span class="keywordtype">int</span> generator_flag, <span class="keywordtype">int</span> L){</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">//return check matric a for generating toric code, cubic code and hypercubic code.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">switch</span>(generator_flag){</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">case</span> 1: <span class="keywordflow">return</span> <a class="code" href="concatenation_8c.html#ab0225f9bae1ebdd84aed9d8f8b0bb507">get_check_rept</a>(L);<span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordflow">case</span> 2: <span class="keywordflow">return</span> <a class="code" href="concatenation_8c.html#a8f123f5d9d72ac4361c03dfb97cc5095">get_check_code734</a>(L);<span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  <span class="keywordflow">case</span> 3: <span class="keywordflow">return</span> <a class="code" href="concatenation_8c.html#a6c0623e3870740a7b530e5ac1e34a1d2">get_check_code743</a>(L);<span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">//default</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="concatenation_8c.html#ab0225f9bae1ebdd84aed9d8f8b0bb507">get_check_rept</a>(L);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">//  return get_check_734(L);//code [7,3,4]</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">//  return get_check_743(L);//code [7,4,3]</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">//  return get_check_rept(L); //circulant check matrix for repetition code.</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;}</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">itpp::LDPC_Code get_test_LDPC_Code(){</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">  //convert itpp::GF2mat saved in .mm file to LDPC_Code</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">  //  itpp::GF2mat G=MM_to_GF2mat(filename);</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">  itpp::GF2mat G = get_check_code734(7*2);</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">  GF2mat_sparse Gs=G.sparsify();</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">  itpp::GF2mat_sparse_alist Gsa;</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">  Gsa.from_sparse(Gs);</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">  itpp::LDPC_Parity H(Gsa);</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">  itpp::LDPC_Code C(&amp;H);</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">  return C;</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">  }*/</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno"><a class="line" href="namespacecommon.html#ab92eccd6f3729363dd662c61989b1b7b">  550</a></span>&#160;itpp::LDPC_Code <a class="code" href="namespacecommon.html#ab92eccd6f3729363dd662c61989b1b7b">common::GF2mat_to_LDPC_Code</a>(itpp::GF2mat G){</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  itpp::GF2mat_sparse Gs=G.sparsify();</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  itpp::GF2mat_sparse_alist Gsa;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  Gsa.from_sparse(Gs);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  itpp::LDPC_Parity H(Gsa);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  itpp::LDPC_Code C(&amp;H);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="keywordflow">return</span> C;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;}</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  </div>
<div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="namespacecommon.html#adc4095333355f0d6367ae3cf4918ed4c">  559</a></span>&#160;itpp::LDPC_Code <a class="code" href="namespacecommon.html#adc4095333355f0d6367ae3cf4918ed4c">common::MM_to_LDPC_Code</a>(<span class="keywordtype">char</span> * filename){</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="comment">//convert itpp::GF2mat saved in .mm file to itpp::LDPC_Code</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  itpp::GF2mat G=<a class="code" href="mm__read_8cpp.html#aa9327aa94412ecbfcd67af03cceb8550">MM_to_GF2mat</a>(filename);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordflow">return</span>  <a class="code" href="css_8h.html#a220665043b4080100ef334e3acf1d848">GF2mat_to_LDPC_Code</a>(G);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">  itpp::GF2mat_sparse Gs=G.sparsify();</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">  itpp::GF2mat_sparse_alist Gsa;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">  Gsa.from_sparse(Gs);</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">  itpp::LDPC_Parity H(Gsa);</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">  itpp::LDPC_Code C(&amp;H);</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">  return C;*/</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;}</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="alib_8h_html"><div class="ttname"><a href="lib_8h.html">lib.h</a></div><div class="ttdoc">lib for general functions, defined within namespace common</div></div>
<div class="ttc" id="aconcatenation_8c_html_a8f123f5d9d72ac4361c03dfb97cc5095"><div class="ttname"><a href="concatenation_8c.html#a8f123f5d9d72ac4361c03dfb97cc5095">get_check_code734</a></div><div class="ttdeci">GF2mat get_check_code734(int L)</div><div class="ttdef"><b>Definition:</b> <a href="concatenation_8c_source.html#l00043">concatenation.c:43</a></div></div>
<div class="ttc" id="anamespacecommon_html_a4e11db412889fa91c60dd3d6463ac1c3"><div class="ttname"><a href="namespacecommon.html#a4e11db412889fa91c60dd3d6463ac1c3">common::classical_dist</a></div><div class="ttdeci">int classical_dist(itpp::GF2mat G)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00114">dist.cpp:114</a></div></div>
<div class="ttc" id="acss_8h_html_ac6c0c617396c45d8ca4df6a9a5eec668"><div class="ttname"><a href="css_8h.html#ac6c0c617396c45d8ca4df6a9a5eec668">G_x</a></div><div class="ttdeci">itpp::GF2mat G_x</div><div class="ttdef"><b>Definition:</b> <a href="css_8h_source.html#l00002">css.h:2</a></div></div>
<div class="ttc" id="anamespacecommon_html_a5d93210c56c7f5315b9341a66a87828f"><div class="ttname"><a href="namespacecommon.html#a5d93210c56c7f5315b9341a66a87828f">common::get_check</a></div><div class="ttdeci">itpp::GF2mat get_check(int generator_flag, int L)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00524">dist.cpp:524</a></div></div>
<div class="ttc" id="anamespacecommon_html_aefd63d8b6f5191f95cd661ea837f7418"><div class="ttname"><a href="namespacecommon.html#aefd63d8b6f5191f95cd661ea837f7418">common::nullSpace</a></div><div class="ttdeci">itpp::GF2mat nullSpace(itpp::GF2mat G)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00133">dist.cpp:133</a></div></div>
<div class="ttc" id="anamespacecommon_html_a2870fe9e08d03362c8fb728d874d88f4"><div class="ttname"><a href="namespacecommon.html#a2870fe9e08d03362c8fb728d874d88f4">common::get_check_code734</a></div><div class="ttdeci">itpp::GF2mat get_check_code734(int L)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00471">dist.cpp:471</a></div></div>
<div class="ttc" id="acss_8h_html_a220665043b4080100ef334e3acf1d848"><div class="ttname"><a href="css_8h.html#a220665043b4080100ef334e3acf1d848">GF2mat_to_LDPC_Code</a></div><div class="ttdeci">itpp::LDPC_Code GF2mat_to_LDPC_Code(itpp::GF2mat G)</div></div>
<div class="ttc" id="anamespacecommon_html_ab92eccd6f3729363dd662c61989b1b7b"><div class="ttname"><a href="namespacecommon.html#ab92eccd6f3729363dd662c61989b1b7b">common::GF2mat_to_LDPC_Code</a></div><div class="ttdeci">itpp::LDPC_Code GF2mat_to_LDPC_Code(itpp::GF2mat G)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00550">dist.cpp:550</a></div></div>
<div class="ttc" id="amm__read_8cpp_html_aa9327aa94412ecbfcd67af03cceb8550"><div class="ttname"><a href="mm__read_8cpp.html#aa9327aa94412ecbfcd67af03cceb8550">MM_to_GF2mat</a></div><div class="ttdeci">itpp::GF2mat MM_to_GF2mat(std::string file_name)</div><div class="ttdef"><b>Definition:</b> <a href="mm__read_8cpp_source.html#l00036">mm_read.cpp:36</a></div></div>
<div class="ttc" id="aconcatenation_8c_html_a6c0623e3870740a7b530e5ac1e34a1d2"><div class="ttname"><a href="concatenation_8c.html#a6c0623e3870740a7b530e5ac1e34a1d2">get_check_code743</a></div><div class="ttdeci">GF2mat get_check_code743(int L)</div><div class="ttdef"><b>Definition:</b> <a href="concatenation_8c_source.html#l00061">concatenation.c:61</a></div></div>
<div class="ttc" id="anamespacecommon_html_a5a49dcd20316566f32d75e6325e74307"><div class="ttname"><a href="namespacecommon.html#a5a49dcd20316566f32d75e6325e74307">common::find_error</a></div><div class="ttdeci">itpp::bvec find_error(itpp::bvec e_in, itpp::GF2mat H)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00446">dist.cpp:446</a></div></div>
<div class="ttc" id="adist_8h_html"><div class="ttname"><a href="dist_8h.html">dist.h</a></div><div class="ttdoc">distance related functions, defined within namespace common</div></div>
<div class="ttc" id="acss_8h_html_a20465bc2a190632eb5e68a21065b7c5b"><div class="ttname"><a href="css_8h.html#a20465bc2a190632eb5e68a21065b7c5b">G_z</a></div><div class="ttdeci">itpp::GF2mat G_z</div><div class="ttdef"><b>Definition:</b> <a href="css_8h_source.html#l00003">css.h:3</a></div></div>
<div class="ttc" id="amm__write_8h_html"><div class="ttname"><a href="mm__write_8h.html">mm_write.h</a></div></div>
<div class="ttc" id="anamespacecommon_html_ae2ba17139296db4319223227af72e99d"><div class="ttname"><a href="namespacecommon.html#ae2ba17139296db4319223227af72e99d">common::quantum_dist_v2</a></div><div class="ttdeci">int quantum_dist_v2(itpp::GF2mat G_x, itpp::GF2mat G_z, int flip=0)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00179">dist.cpp:179</a></div></div>
<div class="ttc" id="acss_8h_html_a27ae1dd5b3bc312c4c9942074b80b3fe"><div class="ttname"><a href="css_8h.html#a27ae1dd5b3bc312c4c9942074b80b3fe">min_wt_decoding</a></div><div class="ttdeci">class CSS min_wt_decoding(itpp::GF2mat C)</div></div>
<div class="ttc" id="amm__write_8cpp_html_a43fa4cd6780c2cae3ae6a9a70004cb45"><div class="ttname"><a href="mm__write_8cpp.html#a43fa4cd6780c2cae3ae6a9a70004cb45">mat_to_MM</a></div><div class="ttdeci">int mat_to_MM(itpp::mat G, char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="mm__write_8cpp_source.html#l00073">mm_write.cpp:73</a></div></div>
<div class="ttc" id="anamespacecommon_html_a1b9cada7d2095a6979d19ac55144fb0a"><div class="ttname"><a href="namespacecommon.html#a1b9cada7d2095a6979d19ac55144fb0a">common::make_it_full_rank</a></div><div class="ttdeci">itpp::GF2mat make_it_full_rank(itpp::GF2mat fat)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8cpp_source.html#l00123">lib.cpp:123</a></div></div>
<div class="ttc" id="anamespacecommon_html_ae8dffa9806ddd0d220fb09db4ccf557c"><div class="ttname"><a href="namespacecommon.html#ae8dffa9806ddd0d220fb09db4ccf557c">common::save_dist</a></div><div class="ttdeci">int save_dist(int d, char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00073">dist.cpp:73</a></div></div>
<div class="ttc" id="acss_8h_html_a92e1a1f0761f740c218c54bd7a694e9f"><div class="ttname"><a href="css_8h.html#a92e1a1f0761f740c218c54bd7a694e9f">getC</a></div><div class="ttdeci">itpp::GF2mat getC(itpp::GF2mat G_x, itpp::GF2mat G_z, int flip=0)</div></div>
<div class="ttc" id="aconcatenation_8c_html_ab0225f9bae1ebdd84aed9d8f8b0bb507"><div class="ttname"><a href="concatenation_8c.html#ab0225f9bae1ebdd84aed9d8f8b0bb507">get_check_rept</a></div><div class="ttdeci">GF2mat get_check_rept(int L)</div><div class="ttdef"><b>Definition:</b> <a href="concatenation_8c_source.html#l00085">concatenation.c:85</a></div></div>
<div class="ttc" id="acss_8h_html_ad621ceea86c12918ae754e4c2de2e7dc"><div class="ttname"><a href="css_8h.html#ad621ceea86c12918ae754e4c2de2e7dc">draw_toric_x_error</a></div><div class="ttdeci">int draw_toric_x_error(itpp::bvec error_bits)</div></div>
<div class="ttc" id="acss_8h_html_a14c9dbab105f1b8b8182a022d73e610c"><div class="ttname"><a href="css_8h.html#a14c9dbab105f1b8b8182a022d73e610c">INF</a></div><div class="ttdeci">const int INF</div><div class="ttdef"><b>Definition:</b> <a href="css_8h_source.html#l00015">css.h:15</a></div></div>
<div class="ttc" id="anamespacecommon_html_aa6ee21f31592282a5308891946fa742a"><div class="ttname"><a href="namespacecommon.html#aa6ee21f31592282a5308891946fa742a">common::hypergraph_dist</a></div><div class="ttdeci">int hypergraph_dist(itpp::GF2mat Aj, itpp::GF2mat Ajplus, int dist_expected, int flip=0)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00292">dist.cpp:292</a></div></div>
<div class="ttc" id="anamespacecommon_html_ae0e9f18c9c64fdb743ffaf3e7746bfc9"><div class="ttname"><a href="namespacecommon.html#ae0e9f18c9c64fdb743ffaf3e7746bfc9">common::rand_dist</a></div><div class="ttdeci">int rand_dist(itpp::GF2mat C, int perm_try=10)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00082">dist.cpp:82</a></div></div>
<div class="ttc" id="anamespacecommon_html_ab7d9f3797598153b6972dd52466e47b3"><div class="ttname"><a href="namespacecommon.html#ab7d9f3797598153b6972dd52466e47b3">common::get_check_code743</a></div><div class="ttdeci">itpp::GF2mat get_check_code743(int L)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00490">dist.cpp:490</a></div></div>
<div class="ttc" id="anamespacecommon_html_a6226b1e6cf8154a83d19b11a12c659ef"><div class="ttname"><a href="namespacecommon.html#a6226b1e6cf8154a83d19b11a12c659ef">common::get_check_rept</a></div><div class="ttdeci">itpp::GF2mat get_check_rept(int L)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00513">dist.cpp:513</a></div></div>
<div class="ttc" id="anamespacecommon_html_a14101bccfd5653a95f9f6c552595c062"><div class="ttname"><a href="namespacecommon.html#a14101bccfd5653a95f9f6c552595c062">common::draw_toric_x_error</a></div><div class="ttdeci">int draw_toric_x_error(itpp::bvec error_bits)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00389">dist.cpp:389</a></div></div>
<div class="ttc" id="amm__read_8h_html"><div class="ttname"><a href="mm__read_8h.html">mm_read.h</a></div></div>
<div class="ttc" id="anamespacecommon_html_adc4095333355f0d6367ae3cf4918ed4c"><div class="ttname"><a href="namespacecommon.html#adc4095333355f0d6367ae3cf4918ed4c">common::MM_to_LDPC_Code</a></div><div class="ttdeci">itpp::LDPC_Code MM_to_LDPC_Code(char *filename)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00559">dist.cpp:559</a></div></div>
<div class="ttc" id="anamespacecommon_html_a71f7ab65b8afbe48b20c3f0bf1718920"><div class="ttname"><a href="namespacecommon.html#a71f7ab65b8afbe48b20c3f0bf1718920">common::color_text</a></div><div class="ttdeci">std::string color_text(std::string str)</div><div class="ttdef"><b>Definition:</b> <a href="lib_8cpp_source.html#l00032">lib.cpp:32</a></div></div>
<div class="ttc" id="anamespacecommon_html_a71dea63a10493ab59f4545a2e1e8f94a"><div class="ttname"><a href="namespacecommon.html#a71dea63a10493ab59f4545a2e1e8f94a">common::quantum_dist</a></div><div class="ttdeci">int quantum_dist(itpp::GF2mat G_x, itpp::GF2mat G_z, int dist_expected, int debug, int flip=0)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00228">dist.cpp:228</a></div></div>
<div class="ttc" id="anamespacecommon_html_ab4dbe7a319fbe38de1b2580a23c91d0a"><div class="ttname"><a href="namespacecommon.html#ab4dbe7a319fbe38de1b2580a23c91d0a">common::getC</a></div><div class="ttdeci">itpp::GF2mat getC(itpp::GF2mat G_x, itpp::GF2mat G_z, int flip=0)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00143">dist.cpp:143</a></div></div>
<div class="ttc" id="acss_8h_html_a35934c85caabcc67d8f42d2d9aceec5d"><div class="ttname"><a href="css_8h.html#a35934c85caabcc67d8f42d2d9aceec5d">rand_dist</a></div><div class="ttdeci">int rand_dist(itpp::GF2mat C, int perm_try=10)</div></div>
<div class="ttc" id="anamespacecommon_html_a465d743c58916cfea99a1e51a5f01c59"><div class="ttname"><a href="namespacecommon.html#a465d743c58916cfea99a1e51a5f01c59">common::min_wt_decoding</a></div><div class="ttdeci">int min_wt_decoding(itpp::GF2mat C)</div><div class="ttdef"><b>Definition:</b> <a href="dist_8cpp_source.html#l00012">dist.cpp:12</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a9c213a27231a52ff96793c1fd60c874.html">weilei_lib</a></li><li class="navelem"><a class="el" href="dist_8cpp.html">dist.cpp</a></li>
    <li class="footer">Generated on Mon Jun 15 2020 12:04:51 for CSS product code by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
